<!DOCTYPE html><html lang="en"><head><title> BrewPiLess Configuration </title><script>function s_ajax(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){4==e.readyState&&(200==e.status?t.success(e.responseText):e.onerror(e.status))},e.ontimeout=function(){void 0!==t.timeout?t.timeout():e.onerror(-1)},e.onerror=function(e){void 0!==t.fail&&t.fail(e)},e.open(t.m,t.url,!0),void 0!==t.data?(e.setRequestHeader("Content-Type",void 0!==t.mime?t.mime:"application/x-www-form-urlencoded"),e.send(t.data)):e.send()}var Q=function(e){return document.querySelector(e)}</script><script>function formatIP(e){return"0.0.0.0"==e?"":e}function verifyIP(e){var t=this.value.split("."),a=!0;if(4==t.length)for(var n=0;n<4;n++){if(255<parseInt(t[n])){a=!1;break}}else a=""==this.value;this.value=a?(this.saved=this.value,formatIP(this.value)):formatIP(this.saved)}function loadSetting(){s_ajax({url:"config?cfg=1",m:"GET",success:function(e){var a=JSON.parse(e);window.oridata=a,Object.keys(a).map(function(e){var t=Q("input[name="+e+"]");t?t.classList.contains("iptype")?(t.value=formatIP(a[e]),t.saved=a[e],t.onchange=verifyIP):"checkbox"==t.type?t.checked=0!=a[e]:t.value=a[e]:(t=Q("select[name="+e+"]"))&&(t.value=a[e])})},fail:function(e){alert("error getting data:"+e)}})}function waitrestart(){Q("#waitprompt").style.display="block",Q("#inputform").style.display="none",setTimeout(function(){window.location.reload()},15e3)}function save(){var n=document.querySelectorAll("input"),i={},o=!1;Object.keys(n).map(function(e,t){var a;"submit"!=n[t].type&&(n[t].name&&""!=n[t].name&&(a=n[t].classList.contains("iptype")?n[t].saved:"checkbox"==n[t].type?n[t].checked?1:0:n[t].value.trim(),i[n[t].name]=a,window.oridata[n[t].name]==a||n[t].classList.contains("nb")||(o=!0)))});var e=Q("select[name=wifi]");window.oridata.wifi!=e.value&&(o=!0),i.wifi=e.value,console.log(JSON.stringify(i)),s_ajax({url:"config"+(o?"":"?nb"),data:"data="+encodeURIComponent(JSON.stringify(i)),m:"POST",success:function(e){o&&waitrestart()},fail:function(e){alert("error saving data:"+e)}})}function load(){Q("#verinfo")&&(Q("#verinfo").innerHTML="v"+JSVERSION),loadSetting()}</script><style>#waitprompt{display:none}</style></head><body onload=load()><div id=waitprompt> Congfiuration saved. Wait for restart... (note: if the hostname is changed, the page won't be reloaded.) </div><div id=inputform><form action=/setconfig action=post><table><tr><td> LCD auto off </td><td><input name=aoff type=text size=5 maxlength=5 class=nb> seconds </td></tr><tr><td> Title </td><td><input name=title type=text size=12 maxlength=24></td></tr><tr><td> Host/Network Name </td><td><input name=name type=text size=12 maxlength=16></td></tr><tr><td> HTTP Port </td><td><input name=port type=text size=5 maxlength=5></td></tr><tr><td> User Name </td><td><input name=user type=text size=12 maxlength=16></td></tr><tr><td> Password </td><td><input name=pass type=password size=12 maxlength=16></td></tr><tr><td> Always ask for password </td><td><input type=checkbox name=protect></td></tr><tr><td> Network </td><td><select name=wifi><option value=1>Station</option><option value=2>AP</option><option value=3>Station + AP</option></select></td></tr><tr><td> Fixed IP </td><td><input type=text name=ip size=16 class=iptype></td></tr><tr><td> Gateway </td><td><input type=text name=gw size=16 class=iptype></td></tr><tr><td> Netmask </td><td><input type=text name=mask size=16 class=iptype></td></tr><tr><td> Save Change </td><td><input type=submit name=submit onclick="return save(),!1"></td></tr></table></form></div></body></html>