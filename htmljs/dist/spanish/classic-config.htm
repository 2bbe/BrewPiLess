<!DOCTYPE html><html lang="es"><head><title> Configuraci&oacute;n BrewPiLess </title><script>function s_ajax(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&(200==t.status?e.success(t.responseText):t.onerror(t.status))},t.ontimeout=function(){void 0!==e.timeout?e.timeout():t.onerror(-1)},t.onerror=function(t){void 0!==e.fail&&e.fail(t)},t.open(e.m,e.url,!0),void 0!==e.data?(t.setRequestHeader("Content-Type",void 0!==e.mime?e.mime:"application/x-www-form-urlencoded"),t.send(e.data)):t.send()}var Q=function(e){return document.querySelector(e)}</script><script>function formatIP(e){return"0.0.0.0"==e?"":e}function verifyIP(e){var t=this.value.split("."),a=!0;if(4==t.length)for(var i=0;i<4;i++){if(parseInt(t[i])>255){a=!1;break}}else a=""==this.value;a?(this.saved=this.value,this.value=formatIP(this.value)):this.value=formatIP(this.saved)}function loadSetting(){s_ajax({url:"config?cfg=1",m:"GET",success:function(e){var t=JSON.parse(e);window.oridata=t,Object.keys(t).map(function(e){var a=Q("input[name="+e+"]");a?a.classList.contains("iptype")?(a.value=formatIP(t[e]),a.saved=t[e],a.onchange=verifyIP):"checkbox"==a.type?a.checked=0!=t[e]:a.value=t[e]:(a=Q("select[name="+e+"]"))&&(a.value=t[e])})},fail:function(e){alert("error al recibir informaci&oacute;n::"+e)}})}function waitrestart(){Q("#waitprompt").style.display="block",Q("#inputform").style.display="none",setTimeout(function(){window.location.reload()},15e3)}function save(){var e=document.querySelectorAll("input"),t={},a=!1;Object.keys(e).map(function(i,n){var o;"submit"!=e[n].type&&(e[n].name&&""!=e[n].name&&(o=e[n].classList.contains("iptype")?e[n].saved:"checkbox"==e[n].type?e[n].checked?1:0:e[n].value.trim(),t[e[n].name]=o,window.oridata[e[n].name]==o||e[n].classList.contains("nb")||(a=!0)))});var i=Q("select[name=wifi]");window.oridata.wifi!=i.value&&(a=!0),t.wifi=i.value,console.log(JSON.stringify(t)),s_ajax({url:"config"+(a?"":"?nb"),data:"data="+encodeURIComponent(JSON.stringify(t)),m:"POST",success:function(e){a&&waitrestart()},fail:function(e){alert("error al guardar informaci&oacute;n::"+e)}})}function load(){Q("#verinfo")&&(Q("#verinfo").innerHTML="v"+JSVERSION),loadSetting()}</script><style>#waitprompt{display:none}</style></head><body onload=load()><div id=waitprompt> Configuraci&oacute;n guardada. Espere a reiniciar... (nota: si se cambia el nombre del servidor, la p&aacute;gina no se volver&aacute; a cargar.) </div><div id=inputform><form action=/setconfig action=post><table><tr><td> Apagar LCD desp&uacute;es de  </td><td><input name=aoff type=text size=5 maxlength=5 class=nb> segundos </td></tr><tr><td> T&iacute;tulo </td><td><input name=title type=text size=12 maxlength=24></td></tr><tr><td> Nombre Host/Network </td><td><input name=name type=text size=12 maxlength=16></td></tr><tr><td> Puerto HTTP </td><td><input name=port type=text size=5 maxlength=5></td></tr><tr><td> Nombre Usuario </td><td><input name=user type=text size=12 maxlength=16></td></tr><tr><td> Contrase&ntilde;a </td><td><input name=pass type=password size=12 maxlength=16></td></tr><tr><td> Solicitar siempre contrase&ntilde;a </td><td><input type=checkbox name=protect></td></tr><tr><td> Network </td><td><select name=wifi><option value=1>Station</option><option value=2>AP</option><option value=3>Station + AP</option></select></td></tr><tr><td> IP Fija </td><td><input type=text name=ip size=16 class=iptype></td></tr><tr><td> Gateway </td><td><input type=text name=gw size=16 class=iptype></td></tr><tr><td> Netmask </td><td><input type=text name=mask size=16 class=iptype></td></tr><tr><td> Guardar </td><td><input type=submit name=submit onclick="return save(),!1"></td></tr></table></form></div></body></html>